<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JOBDHUNDO | Messages</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <style>
    :root {
      --jd-green: #21b07a;
      --jd-light: #e8fdf5;
      --jd-accent: #aad4e2;
      --jd-text: #2d3436;
    }
    body {
      background-color: var(--jd-light);
      font-family: 'Segoe UI', Arial, sans-serif;
      color: var(--jd-text);
    }

    /* Navbar */
    .jd-navbar {
      background-color: var(--jd-green);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    .jd-navbar .navbar-brand {
      color: #fff;
      font-weight: 800;
      font-size: 1.6rem;
      letter-spacing: -0.5px;
    }

    /* Cards */
    .card {
      border: 1px solid #e9f2ef;
      border-radius: 14px;
    }
    .card-header {
      background: linear-gradient(135deg, var(--jd-green), #1a8e62);
      color: #fff;
      font-weight: 700;
      border-top-left-radius: 14px !important;
      border-top-right-radius: 14px !important;
    }

    /* Recruiter list */
    .list-group-item {
      cursor: pointer;
      transition: background-color 0.2s ease, transform 0.15s ease;
      border: none;
      border-bottom: 1px solid #eef4f2;
    }
    .list-group-item:hover {
      background-color: #f4fffb;
      transform: translateX(2px);
    }
    .list-group-item.active {
      background-color: #e8fdf5 !important;
      color: var(--jd-text);
      font-weight: 600;
      border-left: 4px solid var(--jd-green);
    }

    /* Chat bubbles */
    .chat-bubble {
      border-radius: 12px;
      padding: 10px 14px;
      margin-bottom: 10px;
      max-width: 78%;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    .bubble-recruiter {
      background-color: rgba(33,176,122,0.12);
      border: 1px solid rgba(33,176,122,0.25);
    }
    .bubble-you {
      background-color: #ffffff;
      border: 1px solid #e9f2ef;
    }
    .bubble-system {
      background-color: rgba(255,193,7,0.15);
      border: 1px solid rgba(255,193,7,0.35);
    }

    /* Footer input */
    .input-group .form-control {
      border-radius: 10px 0 0 10px;
      border: 1px solid #dfe7e4;
    }
    .btn-send {
      background-color: var(--jd-green);
      border: none;
      border-radius: 0 10px 10px 0;
      font-weight: 700;
    }
    .btn-send:hover {
      background-color: #1a8e62;
    }

    /* Page spacing */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 24px 0;
    }
    .schedule-btn {
      border-color: #1a8e62;
      color: #1a8e62;
    }
    .schedule-btn:hover {
      background-color: #e8fdf5;
      border-color: var(--jd-green);
      color: var(--jd-green);
    }
    
    /* Extra responsiveness for small devices */
    @media (max-width: 768px) {
    .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    .card-body {
        height: auto !important;   /* Let chat box expand naturally on small screens */
        max-height: 300px;         /* Prevent overflow */
    }

    .jd-navbar .navbar-brand {
        font-size: 1.2rem;         /* Smaller brand text */
    }

    .dropdown .btn {
        font-size: 0.9rem;
        padding: 6px 12px;
    }

    .chat-bubble {
        max-width: 100%;           /* Allow bubbles to use full width on mobile */
    }
    }

    
  </style>
</head>
<body>

<!-- Navbar with Dropdown -->
<nav class="navbar jd-navbar px-3 py-2">
  <div class="container-fluid d-flex justify-content-between align-items-center">
    <!-- Brand -->
    <a class="navbar-brand fw-bold" href="#" style="font-size:1.6rem; letter-spacing:-0.5px;">JobDhundo</a>

    <!-- Dropdown Menu -->
    <div class="dropdown">
      <button class="btn btn-light dropdown-toggle fw-semibold" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        Menu
      </button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li><a class="dropdown-item" href="/home">Home</a></li>
        <li><a class="dropdown-item text-danger" href="/logout">Logout</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mt-4">
  <div class="page-header">
    <h4 class="fw-bold text-success m-0">Messages</h4>
    <button class="btn btn-outline-success schedule-btn" onclick="scheduleInterview()">
      <i class="bi bi-calendar-event"></i> Schedule Interview
    </button>
  </div>

  <div class="row g-4">

    <!-- COMPANY LIST -->
    <div class="col-md-4 col-12">
      <div class="card shadow-sm">
        <div class="card-header">Recruiters</div>
        <ul class="list-group list-group-flush">

          <li class="list-group-item active d-flex justify-content-between align-items-start"
              onclick="loadChat('ABC')" id="ABC">
            <div>
              ABC Pvt Ltd<br><small>Frontend Developer</small>
            </div>
            <span class="badge bg-danger rounded-pill" id="ABC_unread">1</span>
          </li>

          <li class="list-group-item d-flex justify-content-between align-items-start"
              onclick="loadChat('XYZ')" id="XYZ">
            <div>
              XYZ Company<br><small>Data Analyst</small>
            </div>
            <span class="badge bg-danger rounded-pill" id="XYZ_unread">1</span>
          </li>

          <li class="list-group-item d-flex justify-content-between align-items-start"
              onclick="loadChat('TechSoft')" id="TechSoft">
            <div>
              TechSoft Company<br><small>Java Developer</small>
            </div>
            <span class="badge bg-danger rounded-pill" id="TechSoft_unread">1</span>
          </li>

        </ul>
      </div>
    </div>

    <!-- CHAT AREA -->
    <div class="col-md-8 col-12">
      <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center" id="chatHeader">
          ABC Pvt Ltd – Frontend Developer
        </div>

        <div id="chatBox" class="card-body" style="height:340px; overflow-y:auto;"></div>

        <div class="card-footer">
          <div class="input-group">
            <input type="text" id="messageInput" class="form-control"
                   placeholder="Type your message..." onkeypress="sendOnEnter(event)">
            <button class="btn btn-send" onclick="sendMessage()">
              <i class="bi bi-send-fill"></i> Send
            </button>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>

<script>
let currentCompany = "ABC";

let chats = {
  ABC: [{from:"recruiter", text:"Hello Shubham, your profile looks good.", time:"10:30 AM"}],
  XYZ: [{from:"recruiter", text:"We received your application.", time:"09:20 AM"}],
  TechSoft: [{from:"recruiter", text:"Are you available for Java Developer role?", time:"11:00 AM"}]
};

function getTime() {
  return new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
}

function loadChat(company) {
  currentCompany = company;

  document.querySelectorAll('.list-group-item')
    .forEach(item => item.classList.remove('active'));
  document.getElementById(company).classList.add('active');

  const unread = document.getElementById(company+"_unread");
  if (unread) unread.style.display = "none";

  const titles = {
    ABC:"ABC Pvt Ltd – Frontend Developer",
    XYZ:"XYZ Company – Data Analyst",
    TechSoft:"TechSoft Company – Java Developer"
  };
  document.getElementById("chatHeader").innerText = titles[company];
  renderMessages();
}

function renderMessages() {
  const chatBox = document.getElementById("chatBox");
  chatBox.innerHTML = "";

  chats[currentCompany].forEach(msg => {
    if (msg.from === "you") {
      chatBox.innerHTML += `
        <div class="text-end">
          <div class="chat-bubble bubble-you d-inline-block">${msg.text}</div><br>
          <small class="text-muted">You • ${msg.time}</small>
        </div>`;
    } else if (msg.from === "system") {
      chatBox.innerHTML += `
        <div>
          <div class="chat-bubble bubble-system">${msg.text}</div>
          <small class="text-muted">System • ${msg.time}</small>
        </div>`;
    } else {
      chatBox.innerHTML += `
        <div>
          <div class="chat-bubble bubble-recruiter">${msg.text}</div>
          <small class="text-muted">Recruiter • ${msg.time}</small>
        </div>`;
    }
  });

  chatBox.scrollTop = chatBox.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById("messageInput");
  const text = input.value.trim();
  if (!text) return;

  chats[currentCompany].push({from:"you", text, time:getTime()});
  input.value = "";
  renderMessages();
}

function scheduleInterview() {
  chats[currentCompany].push({
    from:"system",
    text:"Interview scheduled on 20 Jan at 11:00 AM",
    time:getTime()
  });
  renderMessages();
}

function sendOnEnter(e) {
  if (e.key === "Enter") sendMessage();
}

loadChat("ABC");
</script>

<!-- Bootstrap JS (for dropdown) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>